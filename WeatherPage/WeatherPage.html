<!DOCTYPE html>

<html lang="en">
  <title>FCC Weather</title>
  
    <head>
        <!--Meta tags-->
	    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	    <meta name="description" content="Anywhere Weather App">
	    <meta name="Author" content="Clifford Crerar">
        <!--Bootstrap-->
	    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
        <!--Jquery-->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <!--Bootstrap Toggle-->
        <link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css" rel="stylesheet">
        <script src="https://gitcdn.github.io/bootstrap-toggle/2.2.2/js/bootstrap-toggle.min.js"></script>
        <!--font awesome-->
	    <script src="https://github.com/CliffCrerar/WEB1/blob/master/Skycons/skycons.js"></script>
        <!--Skycons
        <script src="/Users/cliffordcrerar/Github/WEB1/Skycons/skycons.js"></script>-->
        
        <script src="C:\Users\clifford.crear\Documents\GitHub\WEB1\Skycons\skycons.js"></script>
        
<!--JavaScript-->
        <script type="application/javascript">
        $(document).ready(function(){
            $("#toggle").attr("disabled", true); //disable toggle
            $("#weather").hide() //hide weather info until API is loaded
            var skycons = new Skycons({"color":"white"});             

            //Image variables
            var imageURLLoading = 'http://tinyurl.com/yc64kz2y'
            var imageURLClearDay = 'http://tinyurl.com/yd4rl42o'
            var imageURLClearNight = 'http://tinyurl.com/yconzlaj'
            var imageURLRain = 'http://tinyurl.com/y7xdps6g'
            var imageURLSnowSleet = 'http://tinyurl.com/y8b3owrm'
            var imageURLWind = 'http://tinyurl.com/y7fyz4hy'
            var imageURLFog = 'http://tinyurl.com/y9khzgzt'
            var imageURLCloudyDay = 'http://tinyurl.com/yagqrpup'
            var imageURLCloudyNight = 'http://tinyurl.com/y8vqujzr'
            $("body").css("background-image","url('"+imageURLLoading+"')");//set default background;

            //Weather Variables
            var nowSum = '';
            var nowTemp = 0;
            var nowWind = 0;
            var nowIcon = '';
            var todSum = '';
            var todWind = 0;
            var todTempMin = 0;
            var todTempMax = 0;
            var tomSum = '';
            var tomWind = 0;
            var tomTempMin = 0;
            var tomTempMax = 0;

            //variables for weather data fetch
            var posLat;
            var posLong;
            var sUrl = "https://crossorigin.me/https://api.darksky.net/forecast/";
            var encKey = "o=Fo=>ADn>nprsDCE?ror==s=qAns>qC";
            var apiLink = "";

            //get coordinates and generate API Link
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function(position) {
                    posLat = position.coords.latitude;
                    posLong = position.coords.longitude;
                    apiLink = sUrl + decrypt(encKey) + "/" + posLat + "," + posLong + "?exclude=alerts,flags";
                    getWeatherData(apiLink);
                });
            }

            //wGet darksky object and set weather variables
            function getWeatherData(apiLink) {
                $.getJSON(apiLink, function(forecast){
                    //console.log(forecast);

                    //Set all weather variables default values
                    nowSum = forecast.currently.summary;
                    nowTemp = forecast.currently.temperature;
                    nowWind = forecast.currently.windSpeed;
                    nowIcon = forecast.currently.icon
                    
                    todSum = forecast.daily.data[0].summary;
                    todWind = forecast.daily.data[0].windSpeed;                      
                    todTempMin = forecast.daily.data[0].temperatureMin;
                    todTempMax = forecast.daily.data[0].temperatureMax;

                    tomSum = forecast.daily.data[1].summary;
                    tomWind = forecast.daily.data[1].windSpeed;
                    tomTempMin = forecast.daily.data[1].temperatureMin;
                    tomTempMax = forecast.daily.data[1].temperatureMax;        

                    skycons.add("canvas", Skycons[nowIcon.split("-").join("_").toUpperCase()]); //Set Weather icon
                    skycons.play(); //start icon animation

                    $('#city').html(forecast.timezone.split("/")[1]+", "+forecast.timezone.split("/")[0]) //Set Timezone
                    
                    $("#nowSum").html(nowSum); //Set current Summary
                    $('#nowTemp').html(Math.round(((nowTemp-32)*5)/9)+"&deg C"); //assign temprature in C to html
                    $('#nowWind').html('<span class="fa fa-compass"></span>'+Math.round(nowWind*1.6)+' km') //assign windspeen in km to html
                    
                    $('#todSum').html(todSum); //set today sumary to html
                    $('#todWind').html('<span class="fa fa-compass"></span>'+Math.round(todWind*1.6)+' km'); //set today windspeed to html
                    $('#todTempMin').html('<span class="fa fa-thermometer-quarter"></span>' +Math.round((((todTempMin-32)*5)/9))+'&deg C'); //set today min to html
                    $('#todTempMax').html('<span class="fa fa-thermometer-three-quarters"></span>'+Math.round((((todTempMax-32)*5)/9))+'&deg C'); // set today max to html

                    $('#tomSum').html(tomSum); //set tomorrows summary tohtml
                    $('#tomWind').html('<span class="fa fa-compass"></span>'+Math.round(tomWind*1.6)+' km'); //set tomorrows windspeed to html
                    $('#tomTempMin').html('<span class="fa fa-thermometer-quarter"></span>'+Math.round(((tomTempMin-32)*5)/9)+'&deg C') //assign tomorrow min to html
                    $('#tomTempMax').html('<span class="fa fa-thermometer-three-quarters"></span>'+Math.round(((tomTempMax-32)*5)/9)+'&deg C') //assign tomorrows max to html

                    $("#loading").hide(); //hide loading 
                    $("#toggle").attr("disabled", false);//enable toggle button
                    $("#weather").show() //show weather div

                    setBackground(nowIcon);
                });
            }

            function setBackground(icon) {
                switch (icon) { //case to set background image
                    case ('clear-day'): $('body').css('background-image','url("'+imageURLClearDay+'")'); 
                        break;
                    case ('clear-night'): $('body').css('background-image','url("'+imageURLClearNight+'")'); 
                        break;
                    case ('rain'): $('body').css('background-image','url("'+imageURLRain+'")'); 
                        break;
                    case ('snow'): $('body').css('background-image','url("'+imageURLSnowSleet+'")'); 
                        break;
                    case ('sleet'): $('body').css('background-image','url("'+imageURLSnowSleet+'")'); 
                        break;
                    case ('wind'): $('body').css('background-image','url("'+imageURLWind+'")'); 
                        break;
                    case ('fog'): $('body').css('background-image','url("'+imageURLFog+'")'); 
                        break;
                    case ('cloudy'): $('body').css('background-image','url("'+imageURLCloudyDay+'")'); 
                        break;
                    case ('partly-cloudy-day'): $('body').css('background-image','url("'+imageURLCloudyDay+'")'); 
                        break;
                    case ('partly-cloudy-night'): $('body').css('background-image','url("'+imageURLCloudyNight+'")'); 
                        break;
                    default: $("body").css("background-image","url('"+imageURLLoading+"')");//set default background;
                }
            }

            //Change to fahrenthiet
            $("#toggle").change(function() {
                if ($("#toggle")[0].checked) {
                    $('#nowTemp').html(Math.round(((nowTemp-32)*5)/9)+"&deg C"); //assign temprature in C to html
                    $('#nowWind').html('<span class="fa fa-compass"></span>'+Math.round(nowWind*1.6)+' km') //assign windspeen in km to html
                    $('#todWind').html('<span class="fa fa-compass"></span>'+Math.round(todWind*1.6)+' km'); //set today windspeed to html
                    $('#todTempMin').html('<span class="fa fa-thermometer-quarter"></span>' +Math.round((((todTempMin-32)*5)/9))+'&deg C'); //set today min to html
                    $('#todTempMax').html('<span class="fa fa-thermometer-three-quarters"></span>'+Math.round((((todTempMax-32)*5)/9))+'&deg C'); // set today max to html
                    $('#tomWind').html('<span class="fa fa-compass"></span>'+Math.round(tomWind*1.6)+' km'); //set tomorrows windspeed to html
                    $('#tomTempMin').html('<span class="fa fa-thermometer-quarter"></span>'+Math.round(((tomTempMin-32)*5)/9)+'&deg C') //assign tomorrow min to html
                    $('#tomTempMax').html('<span class="fa fa-thermometer-three-quarters"></span>'+Math.round(((tomTempMax-32)*5)/9)+'&deg C') //assign tomorrows max to html
                } else {
                    $('#nowTemp').html(Math.round(nowTemp)+"&deg F"); //assign temprature in C to html
                    $('#nowWind').html('<span class="fa fa-compass"></span>'+Math.round(nowWind)+' mph') //assign windspeen in km to html
                    $('#todWind').html('<span class="fa fa-compass"></span>'+Math.round(todWind)+' mph'); //set today windspeed to html
                    $('#todTempMin').html('<span class="fa fa-thermometer-quarter"></span>' +Math.round(todTempMin)+'&deg F'); //set today min to html
                    $('#todTempMax').html('<span class="fa fa-thermometer-three-quarters"></span>'+Math.round(todTempMax)+'&deg F'); // set today max to html
                    $('#tomWind').html('<span class="fa fa-compass"></span>'+Math.round(tomWind)+' mph'); //set tomorrows windspeed to html
                    $('#tomTempMin').html('<span class="fa fa-thermometer-quarter"></span>'+Math.round(tomTempMin)+'&deg F') //assign tomorrow min to html
                    $('#tomTempMax').html('<span class="fa fa-thermometer-three-quarters"></span>'+Math.round(tomTempMax)+'&deg F') //assign tomorrows max to html                    
                }
            });

            //Dycryption function
            function decrypt(key) {
                var keyLen = key.length;
                var oLetter = "";
                var nPos = 0;
                var nLetter = "";
                var nKey = "";

                for (i = 0; i < keyLen; i++) {
                    oLetter = key[i];
                    nPos = key.codePointAt(i) - 13;
                    nLetter = String.fromCharCode(nPos);
                    nKey = nKey + nLetter;
                }
                return nKey;
            }

        })
   
        
        </script>

<!--Custom CSS-->
        <style type="text/css">
            body{
                background-attachment: fixed;
	            background-size: cover;
	            background-repeat: no-repeat;
            }

            .bd1 {
                border: 1px solid white;                
            }

            h1{
                font-size: 30px;
                margin: 0px;
                font-family: Courier;
            }

            h2 {
                color: white
            }

            h3 {
                color: white;
            }

            .nav{                
                color: white;
                background-color: #232323;
                padding: 2% 0% 2% 0%;
            }

            .phbb {
                height: 5px; 
                background-color: #eeeeee
            }

            #loading {
                color: white;
                font-size: 20px;
                margin: 2%
            }

            #weather {
                background-color: rgba(0,0,0,0.8);
                width: 600px;
                margin: calc(20px + 1vw) auto 0 auto;
                padding: 1%;
                display: block;
                border-radius: 20px;
            }

            img {
                border-radius: 10px;
            }

            canvas {
                display: block;
                margin: auto;
            }

            span{
                margin: 0px 3px 0px 3px
            }
            
            .fig {
                background-color: rgba(255, 255, 255, 0.3);
                /*border: 5px solid black;*/
                border-radius: 20px
            }

        </style>
    </head>

<!--Body-->
    <body>
        <div class="container-fluid">
            <!--Navbar-->
            <div class="row phbb"></div>
            <div class="nav row">
                <div class="col-sm-9">
                    <h1>
                        <span class="fa fa-free-code-camp"></span>
                            freeCodeCamp Weather
                        <span class="fa fa-snowflake-o"></span>
                    </h1>
                </div>
                <div class="col-sm-3">
                    <input id="toggle" type="checkbox" data-toggle="toggle" data-on="&deg Celsius" data-off="&deg Fahrenheit" checked>
                </div>
            </div>            
            <div class="row phbb"></div>        

            <!--Loading-->
            <div id="loading">
                <h4>Loading weather . . . . . </h4>            
                <p style="color: white;">Powered by:</p>
                <img src="http://tinyurl.com/y9jjn3bb">
            </div>
            
            <!--Weather data container-->
            <div id="weather">
                <h2 id="city" class="text-center">City</h2>
                <canvas id="canvas" width="100" height="100"></canvas>

                <!--Forecast for right now-->
                <div style="padding: 0 20px 0 20px;">
                    <h2 id="now">Right now:</h2>
                    <div class="row fig">                        
                        <div class="col-sm-4">
                            <h3 id="nowSum" class="text-center">
                                nowSum</h3>
                        </div>
                        <div class="col-sm-4">
                            <h3 id="nowWind" class="text-center">
                                <span class="fa fa-compass"></span>
                                nowWind</h3>
                        </div>
                        <div class="col-sm-4">
                            <h3 id="nowTemp" class="text-center">
                                <span class="fa fa-thermometer-half"></span>
                                nowTemp</h3>
                        </div>
                    </div>
                </div>

                <!--forecast for the day-->
                <div style="padding: 0 20px 0 20px;">
                    <h2 id="tod">Today:</h2>
                    <div class="fig">
                        <div class="row">
                            <div class="col-sm-12">
                                <h3 id="todSum" class="text-center">Today Summary</h3>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-sm-4">
                                <h3 id="todWind" class="text-center">
                                    TodWind</h3>
                            </div>
                            <div class="col-sm-4">
                                <h3 id="todTempMin" class="text-center">                                
                                    <span class='fa fa-thermometer-quarter'></span>
                                    TodMin</h3>
                            </div>
                            <div class="col-sm-4">
                                <h3 id="todTempMax" class="text-center">                                                     
                                    <span class="fa fa-thermometer-three-quarters"></span>
                                    TodMax</h3>
                            </div>
                        </div>
                    </div>
                </div>

                <!--forecast for the tomorrow-->
                <div style="padding: 0 20px 0 20px;">
                    <h2 id="tom">Tomorrow:</h2>
                    <div class="fig">
                        <div class="row">
                            <div class="col-sm-12">
                                <h3 id="tomSum" class="text-center"></h3>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-sm-4">
                                <h3 id="tomWind" class="text-center"></h3>
                            </div>
                            <div class="col-sm-4">
                                <h3 id="tomTempMin" class="text-center"></h3>
                            </div>
                            <div class="col-sm-4">
                                <h3 id="tomTempMax" class="text-center"></h3>
                            </div>
                        </div>
                    </div>
                </div>                            
            </div>        
        </div>    
    </body>
</html>

